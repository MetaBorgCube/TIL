module interpreter/eval-stats

imports
  strategolib
  interpreter/eval-var
  rewrite/eval
  signatures/-

signature
  constructors
    Goto : string -> Stat

strategies

  eval-stat-rule = 
    ?Block(<eval-stats>)

  eval-stats = 
    {| EvalVar : map(eval-stat) |}

  eval-stat = //debug(!"eval-stat: "); (
    eval-stat-rule
    <+ EvalGoto
  //)

  eval-stat-rule = 
    IfElse(eval-exp, id, id)
    ; EvalIf
    ; eval-stat

  eval-stat-rule = 
    ?While(e, st*)
    ; where(new => label)
    ; where(<conc>(st*, [Goto(label)]) => st2*)
    ; rules( EvalGoto : Goto(label) -> <eval-stat>IfElse(e, st2*, []) )
    ; <eval-stat> Goto(label)
